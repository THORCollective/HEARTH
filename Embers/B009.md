# B009

Microsoft Playwright testing framework caches versions of various browsers for automated testing. In some version or configurations of this framework, the Firefox version is based on Firefox's Nightly.app, the developer-facing and, by Mozilla's own admission, least stable and secure version of the app. EDRs may flag this version of the app (often saved in this file hierarchy/structure: _"~/Library/Caches/ms-playwright/firefox-<4-digit version number>/firefox/Nightly.app"_) as vulnerable and thus a security concern. These vulnerable apps should be reviewed to determine (1) that it is indeed a legitimate file and not a spoof and (2) whether even a legitimate version of the app should be allowed. Dependencies for testing frameworks should be reviewed and allowed/disallowed as necessary.

| Hunt #       | Idea / Hypothesis          | Tactic    | Notes                             | Tags      | Submitter |
|--------------|----------------------------|-----------|-----------------------------------|-----------|-----------|
| B009    | Microsoft Playwright testing framework caches versions of various browsers for automated testing. In some version or configurations of this framework, the Firefox version is based on Firefox's Nightly.app, the developer-facing and, by Mozilla's own admission, least stable and secure version of the app. EDRs may flag this version of the app (often saved in this file hierarchy/structure: _"~/Library/Caches/ms-playwright/firefox-<4-digit version number>/firefox/Nightly.app"_) as vulnerable and thus a security concern. These vulnerable apps should be reviewed to determine (1) that it is indeed a legitimate file and not a spoof and (2) whether even a legitimate version of the app should be allowed. Dependencies for testing frameworks should be reviewed and allowed/disallowed as necessary. | Defense Evasion (TA0005), Trusted Developer Utilities Proxy Execution (T1127), Masquerading (T1036), Exploitation for Defense Evasion (T1211)  | Awareness should be raised about the flagging of Firefox Nightly.app by EDRs and the necessity for validating all dependencies associated with testing frameworks. | #DefenseEvasion #Masquerading #TrustedDeveloperUtilities #ProxyExecution    | Joshua Hines |

## Why
- This hunt highlights the dangers of dependencies within frameworks; as stated above, many were unaware of the apps existence as no one had manually downloaded it.
- Exploitation of testing frameworks can lead to higher-level access of systems.
- As the vulnerability is related to developer utilities (Microsoft Playwright testing framework), it could be an unexpected foothold into the development environment.

## Implementation Notes
- The flagging of Firefox Nightly.app by EDRs is not uncommon, but awareness should be raised so that companies/enterprises may determine whether the risk is allowed / necessary.
- My colleagues were not even aware of this app's existence as none of them had downloaded it. It was included as a dependency for the testing framework. This highlights the necessity for validating all dependencies associated with testing frameworks.

## References
- https://attack.mitre.org/tactics/TA0005/
- https://attack.mitre.org/techniques/T1127/
- https://attack.mitre.org/techniques/T1036/
- https://attack.mitre.org/techniques/T1211/
- https://www.firefox.com/en-US/firefox/144.0a1/releasenotes/
