# H058

Threat actors are loading legitimate vulnerable drivers such as ThrottleStop.sys and rwdrv.sys from TechPowerUp to gain kernel-level write access, enabling the subsequent loading and execution of unsigned malicious kernel drivers like hlpdrv.sys that terminate security product processes and services.

| Hunt #       | Idea / Hypothesis                                                      | Tactic         | Notes                                                                              | Tags                           | Submitter           |
|--------------|-------------------------------------------------------------------------|----------------|------------------------------------------------------------------------------------|--------------------------------|---------------------|
| H058 | Threat actors are loading legitimate vulnerable drivers such as ThrottleStop.sys and rwdrv.sys from TechPowerUp to gain kernel-level write access, enabling the subsequent loading and execution of unsigned malicious kernel drivers like hlpdrv.sys that terminate security product processes and services. | Privilege Escalation | Based on ATT&CK technique T1068. Generated by [hearth-auto-intel](https://github.com/THORCollective/HEARTH). | #privilege_escalation #T1068 #BYOVD #EDR_killer #ransomware | [Duc Viet Hoang](https://linkedin.com/in/hvdtsof/) |

## Why
- This Bring Your Own Vulnerable Driver (BYOVD) technique is a critical precursor to ransomware deployment, used by multiple ransomware groups including Akira, Medusa, Qilin, and Crytox to disable endpoint security products before encryption
- The specific driver combination (ThrottleStop.sys/rwdrv.sys paired with hlpdrv.sys) is a distinctive indicator of Shanya-packed EDR killers, providing high-fidelity detection opportunities with low false positive rates
- Detecting vulnerable driver loading events allows security teams to intervene before the malicious unsigned driver is loaded and security products are terminated, preventing the subsequent ransomware deployment
- This technique represents a detection gap as many security tools focus on process-level behaviors rather than kernel driver loading sequences, making it an ideal hunting opportunity

## References
- [MITRE ATT&CK T1068 - Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068/)
- [Source CTI Report](https://news.sophos.com/en-us/2025/12/06/inside-shanya-a-packer-as-a-service-fueling-modern-attacks/)
