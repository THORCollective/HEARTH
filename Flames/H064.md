# H064

Threat actors are using Punycode-encoded International Domain Names (IDNs) with the "xn--" prefix in DNS queries to masquerade visually similar domain names that impersonate legitimate services for credential harvesting and malware delivery.

| Hunt #       | Idea / Hypothesis                                                      | Tactic         | Notes                                                                              | Tags                           | Submitter           |
|--------------|-------------------------------------------------------------------------|----------------|------------------------------------------------------------------------------------|--------------------------------|---------------------|
| H064 | Threat actors are using Punycode-encoded International Domain Names (IDNs) with the "xn--" prefix in DNS queries to masquerade visually similar domain names that impersonate legitimate services for credential harvesting and malware delivery. | Defense Evasion | Based on ATT&CK technique T1036.005. Generated by [hearth-auto-intel](https://github.com/THORCollective/HEARTH). | #defense_evasion #T1036_005 #punycode #idn #dns | DarkWizardCatcher |

## Why
- Punycode-encoded IDNs allow attackers to create domains that are visually indistinguishable from legitimate domains (e.g., replacing ASCII "o" with Greek "Î¿"), making them highly effective for phishing and malware distribution while evading user detection
- These domains remain below the radar in many organizations despite their effectiveness, as security teams often don't actively hunt for the "xn--" prefix pattern in DNS logs
- DNS resolver logs provide a goldmine for detecting this technique, as all Punycode domains must use the "xn--" prefix format, making them easily identifiable through simple pattern matching
- Early detection of Punycode domain usage can prevent credential theft, malware infections, and business email compromise before users interact with malicious content

## References
- [MITRE ATT&CK T1036.005 - Masquerading: Match Legitimate Name or Location](https://attack.mitre.org/techniques/T1036/005/)
- [Source CTI Report](https://isc.sans.edu/diary/Add+Punycode+to+your+Threat+Hunting+Routine/32640/)
