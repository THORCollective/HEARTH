# H048

The Cisco AnyConnect Secure Mobility Client updates for macOS are distributed via a download from https://disthost.umbrella.com/roaming/upgrade/mac_anyconnect/production/. The naming convention of the legitimate file is vpndownloader.app under a generated file path, perhaps like: _"/private/tmp/vpn.<generated-suffix>/vpndownloader.app/Contents/MacOS/vpndownloader"_. This generically named file / file path may be deemed malicious for several reasons:
1. Location - /private/tmp/ is a temporary directory on macOS, often used for short-lived files. Legitimate apps typically don’t install or run persistent binaries from there.
2. File Name - A generated suffix is often used by droppers or downloaders to avoid detection and to make each infection unique.
3. Binary Path - /Contents/MacOS/vpndownloader means it’s a compiled executable inside an .app bundle. If this were from a reputable VPN provider, it would normally live in /Applications/ or ~/Applications/, not inside /private/tmp
Files showing these hallmarks (location, file name, binary path), should be reviewed for validity.

| Hunt #       | Idea / Hypothesis          | Tactic    | Notes                             | Tags      | Submitter |
|--------------|----------------------------|-----------|-----------------------------------|-----------|-----------|
| H048    | The Cisco AnyConnect Secure Mobility Client updates for macOS are distributed via a download from https://disthost.umbrella.com/roaming/upgrade/mac_anyconnect/production/. The naming convention of the legitimate file is vpndownloader.app under a generated file path, perhaps like: _"/private/tmp/vpn.<generated-suffix>/vpndownloader.app/Contents/MacOS/vpndownloader"_. This generically named file / file path may be deemed malicious for several reasons: 1. Location - /private/tmp/ is a temporary directory on macOS, often used for short-lived files. Legitimate apps typically don’t install or run persistent binaries from there. 2. File Name - A generated suffix is often used by droppers or downloaders to avoid detection and to make each infection unique. 3. Binary Path - /Contents/MacOS/vpndownloader means it’s a compiled executable inside an .app bundle. If this were from a reputable VPN provider, it would normally live in /Applications/ or ~/Applications/, not inside /private/tmp Files showing these hallmarks (location, file name, binary path), should be reviewed for validity. | Defense Evasion (TA0005), Execution (TA0002), Masquerading (T1036), Signed Binary Proxy Execution (T1218), Ingress Tool Transfer (T1105)  | The legitimacy of the Cisco vpndownloader can be verified by identifying the running process and capturing command-line information. | #DefenseEvasion #Execution #Masquerading #ProxyExecution    | Joshua Hines |

## Why
- The identified hallmarks of location, file name, and binary path may all be indicators of malicious executables.
- Files/binaries that carry similar hallmarks should be reviewed with scrutiny, especially if their source cannot be verified.

## Implementation Notes
- The legitimacy of the Cisco vpndownloader I encountered was only possible by identifying the vpndownloader.app process running and capturing command-line information. This showed the callout to the legitimate Cisco-owned umbrella domain.
- If no historical process data is identifiable, check for hashes rather than running potentially malicious software.

## References
- https://attack.mitre.org/tactics/TA0005/
- https://attack.mitre.org/tactics/TA0002/
- https://attack.mitre.org/techniques/T1036/
- https://attack.mitre.org/techniques/T1218/
https://attack.mitre.org/techniques/T1105/
