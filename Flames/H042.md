# H042

Threat actors are using PowerShell's Expand-Archive cmdlet to extract malicious CAB files containing encrypted DEMODEX rootkit configurations and shellcode payloads to C:\Windows\debug\ before deleting the original archive to evade detection.

| Hunt # | Idea / Hypothesis | Tactic | Notes | Tags | Submitter |
|--------|------------------|---------|-------|------|-----------|
| H042 | Threat actors are using PowerShell's Expand-Archive cmdlet to extract malicious CAB files containing encrypted DEMODEX rootkit configurations and shellcode payloads to C:\Windows\debug\ before deleting the original archive to evade detection. | Defense Evasion | Based on ATT&CK technique T1140. Generated by hearth-auto-intel. | #defense-evasion #deobfuscate-files #earth-estries | Jocko |

## Why
- The DEMODEX rootkit is a sophisticated persistence mechanism used by Earth Estries APT group
- The new infection chain bundles encrypted configurations and shellcode in CAB files that are deleted after extraction to avoid detection
- This technique allows the attacker to deploy the rootkit while leaving minimal forensic evidence
- Successful detection could reveal ongoing Earth Estries compromises targeting telecommunications and government entities
- Part of larger Chinese APT espionage campaigns targeting critical infrastructure globally

## References
- [MITRE ATT&CK T1140: Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140/)
- [Source CTI Report](https://www.trendmicro.com/en_us/research/24/k/earth-estries.html)
