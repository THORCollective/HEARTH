# H046

Evildoers might be using reverse ssh for Command and Control.

| Hunt #       | Idea / Hypothesis          | Tactic    | Notes                             | Tags      | Submitter |
|--------------|----------------------------|-----------|-----------------------------------|-----------|-----------|
|    H046      | Evildoers might be using reverse ssh for Command and Control.    | Command and Control  | Look for processes with "ssh -R" and use JA4SSH for TLS/JA4+ fingerprinting. | CommandAndControl networktraffic ssh linux windows T1572    | DarkWizardCatcher |

## Why
- Aiming for hunting already executed C2 communications in network.
- If you find something potentially evil it can indicate the host is already compromised and adversary estabilished C2.
- We have seen adversaries using ssh for C2 communication. For example ALPHA SPIDER or Billbug.
- We don't see much of JA4 fingerprinting telemetry ingested in SIEMs and using those for detections. Firewalls them self might already be detecting these kind of activities. Even EDR's don't flag ssh clients with -R activities.

## Implementation Notes
- Look for processes with command line "ssh -R" on endpoints
- While looking for persistence tactic to achieve ssh communication, look for any kind of persistence technique that can execute ssh client binary.
- Your network devices can offer you logging of TLS/JA4+ fingerprinting. You specifically will be using JA4SSH,
in A part you want to look for double padded packet length, in C part there should be all ACK sent by server. In theory the fingerprint can look like this: c76s76_c71s59_c0s70. This regex can be helpful c76s76_c\d+s\d+_c0s\d+
- If you don't have ability of JA4SSH you can also look for SSH traffic between desired networks probably from private network to public network, most likely you will need to dig through more noisy data.

## References
https://github.com/FoxIO-LLC/ja4
https://github.com/Fahrj/reverse-ssh
https://attack.mitre.org/techniques/T1572/
https://medium.com/foxio/ja4-network-fingerprinting-9376fe9ca637
