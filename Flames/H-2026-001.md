# H068

An adversary is compromising software auto-update infrastructure to redirect legitimate update mechanisms into delivering malicious payloads targeting endpoints running widely deployed developer tools to gain initial access and establish persistence.

| Hunt # | Idea / Hypothesis | Tactic | Notes | Tags | Submitter |
|--------|-------------------|--------|-------|------|-----------|
| H068 | An adversary is compromising software auto-update infrastructure to redirect legitimate update mechanisms into delivering malicious payloads targeting endpoints running widely deployed developer tools to gain initial access and establish persistence. | Initial Access | Lotus Blossom (Chinese state-sponsored) compromised Notepad++ hosting infrastructure for ~6 months (June-Dec 2025), redirecting auto-updates to download malicious binaries. Targeted users in Southeast Asia and Central America. The application's updater (gup.exe) lacked authenticity verification. | #initial_access #T1195_002 #supply_chain #auto_update #lotus_blossom #notepadplusplus | [samuel-lucas6](https://github.com/samuel-lucas6) |

## Why
- Software auto-update mechanisms run with user trust and often elevated permissions, making them ideal delivery vehicles — users expect update processes to download and execute new binaries without intervention
- Hunting for update processes (e.g., gup.exe, updater.exe) making network connections to unexpected domains, spawning unusual child processes, or writing executables to temp directories can reveal hijacked update channels
- Applications that lack code signing verification or certificate pinning in their update process are vulnerable to redirection attacks when hosting infrastructure is compromised — the update client has no way to distinguish legitimate from malicious payloads
- These attacks can be highly targeted (only serving malicious updates to specific IP ranges or regions) making them difficult to detect through broad threat intelligence alone — behavioral hunting on update process anomalies is more reliable

## References

- [MITRE ATT&CK T1195.002 - Supply Chain Compromise: Compromise Software Supply Chain](https://attack.mitre.org/techniques/T1195/002/)
- [Notepad++ - Hijacked Incident Info Update](https://notepad-plus-plus.org/news/hijacked-incident-info-update/)
- [Kaspersky/Securelist - Notepad++ Supply Chain Attack](https://securelist.com/notepad-supply-chain-attack/118708/)
- [Rapid7 - Chrysalis Backdoor: Dive into Lotus Blossom's Toolkit](https://www.rapid7.com/blog/post/tr-chrysalis-backdoor-dive-into-lotus-blossoms-toolkit/)
