# H063

Adversaries are directly modifying the user-specific TCC.db database file by leveraging Finder's Full Disk Access permissions to programmatically insert authorization entries, bypassing macOS privacy prompts to gain unauthorized access to protected user directories including Desktop, Documents, and Downloads.

| Hunt #       | Idea / Hypothesis                                                      | Tactic         | Notes                                                                              | Tags                           | Submitter           |
|--------------|-------------------------------------------------------------------------|----------------|------------------------------------------------------------------------------------|--------------------------------|---------------------|
| H063 | Adversaries are directly modifying the user-specific TCC.db database file by leveraging Finder's Full Disk Access permissions to programmatically insert authorization entries, bypassing macOS privacy prompts to gain unauthorized access to protected user directories including Desktop, Documents, and Downloads. | Defense Evasion | Based on ATT&CK technique T1562.001. Generated by [hearth-auto-intel](https://github.com/THORCollective/HEARTH). | #defense_evasion #T1562_001 #macos #tcc #unc1069 | odanh |

## Why
- Direct manipulation of the TCC database represents a critical security control bypass that undermines macOS's core privacy framework, allowing malware to operate with elevated privileges without user consent
- This technique enables unfettered access to sensitive user data including credentials, browser data, messaging applications, and personal documents, directly facilitating the adversary's objective of credential harvesting and financial theft
- UNC1069's DEEPBREATH malware demonstrates sophisticated understanding of macOS internals by staging the TCC folder rename operation through Finder to exploit its Full Disk Access permissions, making this a distinctive and high-impact technique
- Detection of TCC database manipulation is critical as it precedes mass data exfiltration activities and represents a point where the attack chain can be interrupted before sensitive data is compromised
- This technique is particularly dangerous in cryptocurrency and FinTech environments where browser extensions, keychains, and messaging applications contain high-value authentication tokens and credentials

## References
- [MITRE ATT&CK T1562.001 - Impair Defenses: Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001/)
- [Source CTI Report](https://cloud.google.com/blog/topics/threat-intelligence/unc1069-targets-cryptocurrency-ai-social-engineering)
