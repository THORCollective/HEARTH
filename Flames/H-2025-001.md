# H-2025-001

Threat actors are using PowerShell's Get-CimInstance cmdlet to query Win32_OperatingSystem and ConvertTo-Csv to extract MainWindowTitle properties from running processes, exfiltrating environment variables under 99 characters, desktop file inventories via Shell.Application COM object, and mounted drive information to perform comprehensive host reconnaissance within 20 minutes of Gootloader JavaScript execution.

| Hunt #       | Idea / Hypothesis                                                      | Tactic         | Notes                                                                              | Tags                           | Submitter           |
|--------------|-------------------------------------------------------------------------|----------------|------------------------------------------------------------------------------------|--------------------------------|---------------------|
|  | Threat actors are using PowerShell's Get-CimInstance cmdlet to query Win32_OperatingSystem and ConvertTo-Csv to extract MainWindowTitle properties from running processes, exfiltrating environment variables under 99 characters, desktop file inventories via Shell.Application COM object, and mounted drive information to perform comprehensive host reconnaissance within 20 minutes of Gootloader JavaScript execution. | Discovery | Based on ATT&CK technique T1082. Generated by [hearth-auto-intel](https://github.com/THORCollective/HEARTH). | #discovery #T1082 #gootloader #powershell #systeminfo | _(No response)_ |

## Why
- This specific PowerShell reconnaissance pattern occurs within 20 minutes of initial Gootloader infection and represents the earliest detectable post-compromise activity before lateral movement begins
- The combination of Get-CimInstance Win32_OperatingSystem queries, ConvertTo-Csv parsing for MainWindowTitle extraction, Shell.Application COM object usage for desktop enumeration, and the distinctive 99-character environment variable filter creates a highly specific behavioral signature unique to Gootloader's second-stage payload
- Detecting this reconnaissance activity provides defenders with a critical 16+ hour window before Domain Controller compromise occurs, as observed in multiple Huntress cases where DC compromise happened 17 hours after initial infection
- The MainWindowTitle extraction technique is particularly unusual as it reveals sensitive information like open documents and credentials visible in window titles, making it a high-fidelity detection opportunity
- This activity directly precedes hands-on-keyboard operations by Vanilla Tempest, including Kerberoasting, lateral movement via WinRM, and ransomware deployment, making early detection essential to prevent domain-wide compromise

## References
- https://attack.mitre.org/techniques/T1082/
- https://www.huntress.com/blog/gootloader-threat-detection-woff2-obfuscation