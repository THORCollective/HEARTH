# H078

An adversary is operating Havoc C2 teamservers identifiable through a three-tier detection ladder: default `X-Havoc: true` HTTP header (older builds), self-signed certificates generated from a degraded copy of Sliver's cert generator (8 hardcoded organization name combinations), and a distinctive empty 404 response with a computable body hash.

| Hunt # | Idea / Hypothesis | Tactic | Notes | Tags | Submitter |
|--------|-------------------|--------|-------|------|-----------|
| H078 | An adversary is operating Havoc C2 teamservers identifiable through a three-tier detection ladder: default `X-Havoc: true` HTTP header (older builds), self-signed certificates generated from a degraded copy of Sliver's cert generator (8 hardcoded organization name combinations), and a distinctive empty 404 response with a computable body hash. | Command and Control | Havoc is "partially hardened" — X-Havoc header removed in newer builds but cert generation unchanged. The cert code was copied from Sliver but degraded: only 8 org name combos (vs Sliver's dictionary), uses `math/rand` (vs `crypto/rand`), and hardcodes `CN=0.0.0.0` with `postalCode` always present. | #command_and_control #T1573_002 #T1071_001 #havoc #c2 #certificate #external_hunting | Jinx & Salem (THOR Collective) |

## Why

- Havoc is increasingly popular as a Cobalt Strike alternative — used by multiple threat actors
- Havoc represents the "partially hardened" category: devs removed the most obvious fingerprint (X-Havoc header) but left cert generation untouched
- Certificate code lineage traced to Sliver source — but degraded with only 8 hardcoded org combos, making it MORE detectable than Sliver's randomized approach
- `CN=0.0.0.0` is distinctive — rarely seen in legitimate certificates
- Header-stripped Havoc instances on bulletproof hosting still detectable via cert pattern + `/havoc/` endpoint + teamserver 301 redirect
- Default teamserver port 40056 is another supplementary signal

## References

- [ATT&CK T1573.002 — Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002/)
- [ATT&CK T1071.001 — Web Protocols](https://attack.mitre.org/techniques/T1071/001/)
- [Havoc source: teamserver/pkg/common/certs/https.go](https://github.com/HavocFramework/Havoc)
- [Sliver source: server/certs/subject.go](https://github.com/BishopFox/sliver/blob/master/server/certs/subject.go) (origin of Havoc's cert code)
- THOR Collective C2 infrastructure research (2026)
