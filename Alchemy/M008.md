# M008

Cluster process parent-child execution chains across the endpoint fleet to establish baseline lineage frequency, then identify rare or never-seen process trees that deviate from the norm to detect living-off-the-land abuse, novel malware execution, and compromised applications.

| Hunt # | Idea / Hypothesis | Tactic | Notes | Tags | Submitter |
|--------|-------------------|--------|-------|------|-----------|
| M008 | Cluster process parent-child execution chains across the endpoint fleet to establish baseline lineage frequency, then identify rare or never-seen process trees that deviate from the norm to detect living-off-the-land abuse, novel malware execution, and compromised applications. | Execution | Build frequency counts of parent→child process pairs across the fleet over a baseline period. Pairs seen on less than 1% of endpoints or appearing for the first time are flagged for review. Effective across multiple ATT&CK tactics since most attack chains produce abnormal process trees regardless of the specific technique used. | #execution #defense_evasion #model_assisted #process_lineage #clustering #anomaly_detection #T1059 #T1218 | Jinx (THOR Collective) |

## Why

- Nearly every attack technique produces an abnormal process parent-child relationship — chrome.exe spawning finger.exe, winword.exe spawning powershell.exe, or svchost.exe spawning cmd.exe with encoded arguments all stand out when measured against fleet-wide frequency baselines
- Frequency stacking across the fleet turns rarity into signal — a process pair seen on 3 out of 10,000 endpoints is worth investigating regardless of whether that specific combination appears in any detection rule
- This approach catches novel techniques without prior signatures because it measures deviation from normal rather than matching known bad — new LOLBINs, renamed binaries, and zero-day exploitation all produce unusual lineages
- Process creation data with parent process context is already collected by most EDR tools and Sysmon, making this immediately actionable without deploying additional telemetry

## References

- [MITRE ATT&CK T1059 - Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059/)
- [MITRE ATT&CK T1218 - System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218/)
